# Version Strategy and Planning (v0.4 / v0.5)

最終更新: 2026-02-12

## 1. 基本方針

- v0.4は「価値提供機能」を先に商品化する
- v0.5は「エンタープライズ運用機能」を後段で追加する
- APIキー課金モデルは採用しない
  - Self-host / 顧客クラウド導入を主軸にする
  - 契約・NDA・将来の利用量徴収は別フェーズで扱う

## 2. feature/v0.4.0 の仕分け

### A. 既に資産化済み (v0.4土台として採用)

1. Nix + Docker前提の導入自動化
2. OpenAPI/Swagger公開 (`/openapi.json`, `/docs`)
3. MySQL/PostgreSQL統合テスト
4. Redisキャッシュ実装
5. SQLite read-only PoC + 配布アーティファクト生成
6. Dockerマルチステージ最適化
7. GitHub Actions + Terraform + OIDC最小骨格

### B. v0.4.0で追加実装が必要 (今回の主対象)

1. 検索API品質
   - 厳密一致 / 前方一致 / 部分一致
   - かな揺れ吸収（正規化）
2. 更新配布の監査
   - データ版管理
   - 差分ログ
   - 版指定ロールバック
3. 可観測性
   - 構造化ログ
   - エラー率 / レイテンシ指標
   - `/health` と `/ready` の運用分離
4. 導入SDK/サンプル
   - EC配送先補完サンプル
   - 会員登録フォーム補完サンプル

### C. v0.5へ後ろ倒し (v0.4では実装しない)

1. SAML/SSO + 監査証跡
2. IP制限・VPC接続・秘密情報管理
3. SLO/障害Runbook + サポート運用

## 3. Version戦略 (SemVer運用)

1. `v0.4.0`
   - 販売前PoC向けの最小完成版
   - B項目（検索品質/更新監査/可観測性/SDK）を満たした時点でリリース
2. `v0.4.x`
   - バグ修正、性能改善、ドキュメント整備
   - 互換性を壊さない変更のみ
3. `v0.5.0`
   - 企業運用機能を追加する最初のメジャーマイナー
   - 認証/境界防御/運用品質の3本柱を満たした時点でリリース

## 4. ブランチ戦略

1. 長期運用ブランチ
   - `main`: リリース済みのみ
   - `feature/v0.4.0`: v0.4作業集約
2. 作業ブランチ命名
   - `feature/v0.4.0-*` または `feature/v0.5.0-*`
   - `codex/*` は使わない
3. リリースタグ
   - `v0.4.0`, `v0.4.1`, `v0.5.0` の順で固定

## 5. マイルストーン (絶対日付)

1. M1: 2026-02-13 〜 2026-02-22
   - 検索仕様確定（厳密/前方/部分/かな揺れ）
   - DBインデックス方針確定
2. M2: 2026-02-23 〜 2026-03-08
   - 検索API実装 + 統合テストfixture整備
3. M3: 2026-03-09 〜 2026-03-22
   - データ版管理/差分ログ/ロールバック実装
4. M4: 2026-03-23 〜 2026-04-05
   - 可観測性 + SDK/サンプル整備
   - v0.4.0リリース判定

## 6. v0.4.0 Exit Criteria

1. 検索API: 3検索モード + かな揺れケースが統合テストで通る
2. 更新監査: 版追跡/差分記録/ロールバックがCLIで再現可能
3. 可観測性: `health/ready` 分離 + 最低限メトリクス取得可能
4. SDK: JavaScript最小SDK + 2つの導入サンプルが動作
5. ドキュメント: README/販売計画/運用手順がv0.4基準に一致

## 7. 次ターン実施項目

1. `README.md` を v0.4/v0.5 構成に更新
2. `docs/SALES_READINESS_PLAN_2026Q2.md` を v0.4/v0.5 構成に更新
3. v0.4.0タスクを issue/チェックリスト化して進捗管理
